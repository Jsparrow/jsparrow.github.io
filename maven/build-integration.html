<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Build Integration | jSparrow Documentation</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/jsparrow-tab-icon.png">
    <meta name="description" content="">
    <meta name="google-site-verification" content="1EOegR91kbVWv-4x23fHUki6OgU7loau_CsiGDtJHok">
    
    <link rel="preload" href="/assets/css/0.styles.1229d12d.css" as="style"><link rel="preload" href="/assets/js/app.aac9ad5f.js" as="script"><link rel="preload" href="/assets/js/17.56318689.js" as="script"><link rel="preload" href="/assets/js/5.1b99d8b2.js" as="script"><link rel="preload" href="/assets/js/48.35d3eecc.js" as="script"><link rel="prefetch" href="/assets/js/1.c858b974.js"><link rel="prefetch" href="/assets/js/10.4e7ab71e.js"><link rel="prefetch" href="/assets/js/100.6b357bd5.js"><link rel="prefetch" href="/assets/js/101.70a2b8f5.js"><link rel="prefetch" href="/assets/js/102.cec331f7.js"><link rel="prefetch" href="/assets/js/103.e1d6c843.js"><link rel="prefetch" href="/assets/js/104.518804cd.js"><link rel="prefetch" href="/assets/js/105.e2a7836d.js"><link rel="prefetch" href="/assets/js/106.c7fcd695.js"><link rel="prefetch" href="/assets/js/107.1f015b71.js"><link rel="prefetch" href="/assets/js/108.25c52161.js"><link rel="prefetch" href="/assets/js/109.89f6e0f9.js"><link rel="prefetch" href="/assets/js/11.65100cd2.js"><link rel="prefetch" href="/assets/js/110.f1eb2955.js"><link rel="prefetch" href="/assets/js/111.14e267c3.js"><link rel="prefetch" href="/assets/js/112.21942332.js"><link rel="prefetch" href="/assets/js/113.ff34962c.js"><link rel="prefetch" href="/assets/js/114.486d14b3.js"><link rel="prefetch" href="/assets/js/115.bfe7156f.js"><link rel="prefetch" href="/assets/js/116.5b518b7a.js"><link rel="prefetch" href="/assets/js/117.b3181d8b.js"><link rel="prefetch" href="/assets/js/118.6de2ccb4.js"><link rel="prefetch" href="/assets/js/119.88bde78c.js"><link rel="prefetch" href="/assets/js/12.aeb81bf7.js"><link rel="prefetch" href="/assets/js/120.6051a227.js"><link rel="prefetch" href="/assets/js/121.66dc6785.js"><link rel="prefetch" href="/assets/js/122.5cad8a73.js"><link rel="prefetch" href="/assets/js/123.d43f3f17.js"><link rel="prefetch" href="/assets/js/124.3f7e6c8d.js"><link rel="prefetch" href="/assets/js/125.74f0be93.js"><link rel="prefetch" href="/assets/js/126.2e6ff6a6.js"><link rel="prefetch" href="/assets/js/127.d95ebda1.js"><link rel="prefetch" href="/assets/js/128.1391ccc5.js"><link rel="prefetch" href="/assets/js/129.dae98475.js"><link rel="prefetch" href="/assets/js/13.5253c745.js"><link rel="prefetch" href="/assets/js/130.83d922cc.js"><link rel="prefetch" href="/assets/js/131.7acc9cf3.js"><link rel="prefetch" href="/assets/js/132.552b5d3c.js"><link rel="prefetch" href="/assets/js/133.03242714.js"><link rel="prefetch" href="/assets/js/134.a94c27b6.js"><link rel="prefetch" href="/assets/js/135.dd2ac231.js"><link rel="prefetch" href="/assets/js/136.868cb788.js"><link rel="prefetch" href="/assets/js/137.bd14601e.js"><link rel="prefetch" href="/assets/js/138.cf8ea898.js"><link rel="prefetch" href="/assets/js/139.9a79d763.js"><link rel="prefetch" href="/assets/js/14.0e74d67b.js"><link rel="prefetch" href="/assets/js/140.6c471a48.js"><link rel="prefetch" href="/assets/js/141.8e147e40.js"><link rel="prefetch" href="/assets/js/142.05c24721.js"><link rel="prefetch" href="/assets/js/143.9ebc7877.js"><link rel="prefetch" href="/assets/js/144.47990608.js"><link rel="prefetch" href="/assets/js/145.f3f46e76.js"><link rel="prefetch" href="/assets/js/146.06f23052.js"><link rel="prefetch" href="/assets/js/147.690c16e3.js"><link rel="prefetch" href="/assets/js/148.c574de0b.js"><link rel="prefetch" href="/assets/js/149.1304eccf.js"><link rel="prefetch" href="/assets/js/15.a429ef2d.js"><link rel="prefetch" href="/assets/js/150.a2ccf54a.js"><link rel="prefetch" href="/assets/js/151.697d77c5.js"><link rel="prefetch" href="/assets/js/152.a98a4f32.js"><link rel="prefetch" href="/assets/js/153.6088f19d.js"><link rel="prefetch" href="/assets/js/154.802b7571.js"><link rel="prefetch" href="/assets/js/155.5a4705dd.js"><link rel="prefetch" href="/assets/js/156.000e993c.js"><link rel="prefetch" href="/assets/js/157.a347ebb2.js"><link rel="prefetch" href="/assets/js/158.e7aaa83c.js"><link rel="prefetch" href="/assets/js/159.7b42b0a6.js"><link rel="prefetch" href="/assets/js/16.ade8fee8.js"><link rel="prefetch" href="/assets/js/160.9696ff63.js"><link rel="prefetch" href="/assets/js/161.f1cffc46.js"><link rel="prefetch" href="/assets/js/162.c4609362.js"><link rel="prefetch" href="/assets/js/163.416783ba.js"><link rel="prefetch" href="/assets/js/164.b341d5df.js"><link rel="prefetch" href="/assets/js/165.3cbce1fa.js"><link rel="prefetch" href="/assets/js/166.fbf56370.js"><link rel="prefetch" href="/assets/js/167.8d65dc1d.js"><link rel="prefetch" href="/assets/js/168.d7d60e23.js"><link rel="prefetch" href="/assets/js/169.ccdf0432.js"><link rel="prefetch" href="/assets/js/170.2f0e3d6f.js"><link rel="prefetch" href="/assets/js/171.51080af9.js"><link rel="prefetch" href="/assets/js/172.be06b9ac.js"><link rel="prefetch" href="/assets/js/173.beec214d.js"><link rel="prefetch" href="/assets/js/174.b4fef134.js"><link rel="prefetch" href="/assets/js/175.d35526ea.js"><link rel="prefetch" href="/assets/js/176.ad4f776e.js"><link rel="prefetch" href="/assets/js/177.3b3edc8d.js"><link rel="prefetch" href="/assets/js/178.a80d15a5.js"><link rel="prefetch" href="/assets/js/18.88d4bf58.js"><link rel="prefetch" href="/assets/js/19.9dbd871e.js"><link rel="prefetch" href="/assets/js/2.c705bd7e.js"><link rel="prefetch" href="/assets/js/20.e9f621ea.js"><link rel="prefetch" href="/assets/js/21.18703be1.js"><link rel="prefetch" href="/assets/js/22.9e19c976.js"><link rel="prefetch" href="/assets/js/23.7d254c63.js"><link rel="prefetch" href="/assets/js/24.44aaf280.js"><link rel="prefetch" href="/assets/js/25.191c6621.js"><link rel="prefetch" href="/assets/js/26.1dc04b82.js"><link rel="prefetch" href="/assets/js/27.52e530d6.js"><link rel="prefetch" href="/assets/js/28.90310cdf.js"><link rel="prefetch" href="/assets/js/29.185b4d62.js"><link rel="prefetch" href="/assets/js/3.e61b0488.js"><link rel="prefetch" href="/assets/js/30.949d7ba2.js"><link rel="prefetch" href="/assets/js/31.15073a9c.js"><link rel="prefetch" href="/assets/js/32.1108b27d.js"><link rel="prefetch" href="/assets/js/33.6b705776.js"><link rel="prefetch" href="/assets/js/34.9877f6f7.js"><link rel="prefetch" href="/assets/js/35.f8fc58bd.js"><link rel="prefetch" href="/assets/js/36.7a10ff7a.js"><link rel="prefetch" href="/assets/js/37.fd9d9f27.js"><link rel="prefetch" href="/assets/js/38.76e45af3.js"><link rel="prefetch" href="/assets/js/39.2cf12b41.js"><link rel="prefetch" href="/assets/js/40.1d2c49e1.js"><link rel="prefetch" href="/assets/js/41.643b07a5.js"><link rel="prefetch" href="/assets/js/42.9ab2e93f.js"><link rel="prefetch" href="/assets/js/43.917e7e65.js"><link rel="prefetch" href="/assets/js/44.2bb1a835.js"><link rel="prefetch" href="/assets/js/45.46c5c547.js"><link rel="prefetch" href="/assets/js/46.5468b952.js"><link rel="prefetch" href="/assets/js/47.06a171e1.js"><link rel="prefetch" href="/assets/js/49.f65faf18.js"><link rel="prefetch" href="/assets/js/50.2786c290.js"><link rel="prefetch" href="/assets/js/51.53e28d32.js"><link rel="prefetch" href="/assets/js/52.5b9da5ea.js"><link rel="prefetch" href="/assets/js/53.556df5ac.js"><link rel="prefetch" href="/assets/js/54.bccd5c33.js"><link rel="prefetch" href="/assets/js/55.3c29b450.js"><link rel="prefetch" href="/assets/js/56.b25e966e.js"><link rel="prefetch" href="/assets/js/57.86ecc271.js"><link rel="prefetch" href="/assets/js/58.a1e69be3.js"><link rel="prefetch" href="/assets/js/59.c45d0f4e.js"><link rel="prefetch" href="/assets/js/6.3ff8b7a0.js"><link rel="prefetch" href="/assets/js/60.00a4ec94.js"><link rel="prefetch" href="/assets/js/61.debda96e.js"><link rel="prefetch" href="/assets/js/62.b21e8d0b.js"><link rel="prefetch" href="/assets/js/63.3bebba2d.js"><link rel="prefetch" href="/assets/js/64.cb979fe6.js"><link rel="prefetch" href="/assets/js/65.42f7a320.js"><link rel="prefetch" href="/assets/js/66.ec1f557e.js"><link rel="prefetch" href="/assets/js/67.870f2383.js"><link rel="prefetch" href="/assets/js/68.de0fbac4.js"><link rel="prefetch" href="/assets/js/69.5f9cfc94.js"><link rel="prefetch" href="/assets/js/7.fe1e94fe.js"><link rel="prefetch" href="/assets/js/70.8dae848e.js"><link rel="prefetch" href="/assets/js/71.34c74eca.js"><link rel="prefetch" href="/assets/js/72.7623bd5b.js"><link rel="prefetch" href="/assets/js/73.f1f05c3f.js"><link rel="prefetch" href="/assets/js/74.732d1d4a.js"><link rel="prefetch" href="/assets/js/75.cebf3c1c.js"><link rel="prefetch" href="/assets/js/76.d96a2f52.js"><link rel="prefetch" href="/assets/js/77.3f073bbb.js"><link rel="prefetch" href="/assets/js/78.61de48ac.js"><link rel="prefetch" href="/assets/js/79.51957443.js"><link rel="prefetch" href="/assets/js/8.0b8285ab.js"><link rel="prefetch" href="/assets/js/80.75c8b7cb.js"><link rel="prefetch" href="/assets/js/81.6d93e087.js"><link rel="prefetch" href="/assets/js/82.5c5e4f96.js"><link rel="prefetch" href="/assets/js/83.ccd52478.js"><link rel="prefetch" href="/assets/js/84.d27fbfcd.js"><link rel="prefetch" href="/assets/js/85.412b2615.js"><link rel="prefetch" href="/assets/js/86.bc924ab1.js"><link rel="prefetch" href="/assets/js/87.ffe97b8d.js"><link rel="prefetch" href="/assets/js/88.d94c7b7b.js"><link rel="prefetch" href="/assets/js/89.d7c82dda.js"><link rel="prefetch" href="/assets/js/9.868aa898.js"><link rel="prefetch" href="/assets/js/90.c915fb2e.js"><link rel="prefetch" href="/assets/js/91.b376aa2e.js"><link rel="prefetch" href="/assets/js/92.a27c74a2.js"><link rel="prefetch" href="/assets/js/93.a45ba6fc.js"><link rel="prefetch" href="/assets/js/94.71bb6eb9.js"><link rel="prefetch" href="/assets/js/95.a73f880a.js"><link rel="prefetch" href="/assets/js/96.8afba1a8.js"><link rel="prefetch" href="/assets/js/97.e697b9ba.js"><link rel="prefetch" href="/assets/js/98.e69e734a.js"><link rel="prefetch" href="/assets/js/99.146ea7a1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1229d12d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/jsparrow-logo.png" alt="jSparrow Documentation" class="logo"> <span class="site-name can-hide">jSparrow Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/rules/" class="nav-link">
  Rules
</a></div><div class="nav-item"><a href="/tags/" class="nav-link">
  Tags
</a></div><div class="nav-item"><a href="/eclipse/getting-started.html" class="nav-link">
  Eclipse Plugin
</a></div><div class="nav-item"><a href="/maven/getting-started.html" class="nav-link">
  Maven Plugin
</a></div><div class="nav-item"><a href="/statistics/statistics-summary.html" class="nav-link">
  Statistics
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/rules/" class="nav-link">
  Rules
</a></div><div class="nav-item"><a href="/tags/" class="nav-link">
  Tags
</a></div><div class="nav-item"><a href="/eclipse/getting-started.html" class="nav-link">
  Eclipse Plugin
</a></div><div class="nav-item"><a href="/maven/getting-started.html" class="nav-link">
  Maven Plugin
</a></div><div class="nav-item"><a href="/statistics/statistics-summary.html" class="nav-link">
  Statistics
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/maven/getting-started.html" class="sidebar-link">Getting started</a></li><li><a href="/maven/local-license-server.html" class="sidebar-link">Local License Server</a></li><li><a href="/maven/additional-configuration.html" class="sidebar-link">Additional Configuration</a></li><li><a href="/maven/build-integration.html" aria-current="page" class="active sidebar-link">Build Integration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/maven/build-integration.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/maven/build-integration.html#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/maven/build-integration.html#jenkins-configuration" class="sidebar-link">Jenkins Configuration</a></li><li class="sidebar-sub-header"><a href="/maven/build-integration.html#pipeline-configuration" class="sidebar-link">Pipeline Configuration</a></li><li class="sidebar-sub-header"><a href="/maven/build-integration.html#end-result" class="sidebar-link">End Result</a></li></ul></li><li><a href="/maven/troubleshooting.html" class="sidebar-link">Troubleshooting</a></li><li><a href="/maven/release-notes.html" class="sidebar-link">Release Notes</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="build-integration"><a href="#build-integration" class="header-anchor">#</a> Build Integration</h1> <p></p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#requirements">Requirements</a></li><li><a href="#jenkins-configuration">Jenkins Configuration</a><ul><li><a href="#license-key-as-secret-text">License Key as Secret Text</a></li><li><a href="#jsparrow-config-file">jSparrow Config File</a></li></ul></li><li><a href="#pipeline-configuration">Pipeline Configuration</a><ul><li><a href="#tools-configuration">Tools Configuration</a></li><li><a href="#checkout-and-setting-a-flag">Checkout and Setting a Flag</a></li><li><a href="#jsparrow-execution">jSparrow Execution</a></li></ul></li><li><a href="#end-result">End Result</a></li></ul></div><p></p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Integrating the jSparrow Maven plugin into a build process has the advantage of automatically applying selected jSparrow rules in an already automated process.
The configuration is highly customizable and depends very much on the environment.
Here it will be described how Jenkins builds are able to trigger jSparrow Maven plugin builds, depending on the Git branch of the commit. In this example, all builds on a <em>feature</em> branch will trigger jSparrow.</p> <h2 id="requirements"><a href="#requirements" class="header-anchor">#</a> Requirements</h2> <p>This description assumes that the following components are available and correctly setup.</p> <ul><li><a href="https://www.jenkins.io/download/" target="_blank" rel="noopener noreferrer">Jenkins<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li><a href="https://plugins.jenkins.io/pipeline-maven/" target="_blank" rel="noopener noreferrer">Pipeline Maven Integration plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/jenkinsci/stashnotifier-plugin/blob/release/1.x/readme.md" target="_blank" rel="noopener noreferrer">Bitbucket Server Notifier plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://plugins.jenkins.io/ssh-agent/" target="_blank" rel="noopener noreferrer">SSH Agent plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>(<a href="https://www.jenkins.io/doc/book/pipeline/syntax/#declarative-pipeline" target="_blank" rel="noopener noreferrer">Declarative<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) <a href="https://www.jenkins.io/doc/book/pipeline/multibranch/" target="_blank" rel="noopener noreferrer">Multibranch Pipeline<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><a href="https://hub.docker.com/r/atlassian/bitbucket-server/" target="_blank" rel="noopener noreferrer">Bitbucket<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="jenkins-configuration"><a href="#jenkins-configuration" class="header-anchor">#</a> Jenkins Configuration</h2> <p>A jSparrow build requires a license key and a config file (jsparrow.yml) to be present. Both can be kept securely within Jenkins and then referenced by the pipeline.</p> <h3 id="license-key-as-secret-text"><a href="#license-key-as-secret-text" class="header-anchor">#</a> License Key as Secret Text</h3> <p>The jSparrow license key can be provided using the <code>-Dlicense=&lt;license-key&gt;</code> parameter, as described in the <a href="/maven/getting-started.html#plugin-goals">Plugin Goals</a>. However, it might not be desirable to provide the key in plain text.<br>
With the help of Jenkins &quot;secret text&quot; credentials, it is possible to never have the license key appear in the pipeline. Even in log statements the &quot;secret text&quot; will only appear as asterisks.</p> <p>Jenkins lets users add credentials either globally, or build pipeline specific. For one pipeline, there is no practical difference between one or the other.</p> <ol><li>Navigate to the &quot;Add Credentials&quot; either global or pipeline specific
<ul><li>Global: <em>Manage Jenkins</em> -&gt; <em>Manage Credentials</em> -&gt; <em>System</em> (click on &quot;Store&quot;) -&gt; <em>Global credentials (unrestricted)</em></li> <li>Pipeline specific: [Your Pipeline] -&gt; <em>Credentials</em> -&gt; <em>Stores scoped to [Your Pipeline]</em> -&gt; <em>Global credentials (unrestricted)</em></li></ul></li> <li>This is a description of the fields of the following screen:<br> <a href="/img/maven/jenkins-jsparrow-license.png"><img src="/img/maven/jenkins-jsparrow-license.png" alt="jSparrow license"></a> <ul><li>Kind: Select &quot;Secret text&quot;</li> <li>Scope: This needs to be &quot;Global&quot;, otherwise the pipeline will not have access</li> <li>Secret: This is where the jSparrow license key has to be provided.<br>
Note: The content of this variable cannot be viewed anymore after putting it here and it will not appear in logs or echo statements.</li> <li>ID: This is the key with which the secret text can be referenced in the pipeline</li> <li>Description: It is always a good practice to provide a description</li></ul></li></ol> <h3 id="jsparrow-config-file"><a href="#jsparrow-config-file" class="header-anchor">#</a> jSparrow Config File</h3> <p>Customization about which rules to apply or which resources to skip are done in a config file (<code>jsparrow.yml</code>), as described in detail in <a href="/maven/getting-started.html#plugin-configuration">Plugin Configuration</a>.</p> <p>By default, this configuration file is expected to reside in the project's root directory. Alternatively, there is the option to fully manage the jSparrow configuration in Jenkins. This might have the following advantages:</p> <ul><li>The <code>jsparrow.yml</code> does not need to be committed to the project's SCM repository</li> <li>Jenkins administrators can manage the configuration globally</li></ul> <p>The config file can be added as follows:</p> <ol><li>Navigate to <em>Manage Jenkins</em> -&gt; <em>Managed files</em> and click &quot;Add a new Config&quot;</li> <li>Add a new &quot;Custom file&quot; and provide a meaningful ID</li> <li>This is a description of the fields of the following screen:<br> <a href="/img/maven/jenkins-jsparrow-yml-content.png"><img src="/img/maven/jenkins-jsparrow-yml-content.png" alt="jsparrow.yml"></a> <ul><li>ID: The key with which the file will be referenced within the pipeline</li> <li>Name: The file name</li> <li>Comment: An optional description</li> <li>Content: The configuration according to the <a href="/maven/getting-started.html#plugin-configuration">Plugin Configuration</a></li></ul></li></ol> <h2 id="pipeline-configuration"><a href="#pipeline-configuration" class="header-anchor">#</a> Pipeline Configuration</h2> <p>With <a href="https://www.jenkins.io/doc/book/pipeline/multibranch/" target="_blank" rel="noopener noreferrer">Multibranch Pipelines<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, Jenkins offers a way to run builds on all branches of a repository. This is very useful when following a branching model, such as <a href="https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow" target="_blank" rel="noopener noreferrer">Gitflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, where different types of branches have different purposes. The current branch can be determined during runtime (<code>env.BRANCH_NAME</code> or via <a href="https://www.jenkins.io/doc/book/pipeline/syntax/#built-in-conditions" target="_blank" rel="noopener noreferrer">Built-in Condition<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>), making it possible to process certain branches differently.</p> <p>In this example, a declarative Multibranch Pipeline will be configured to run the jSparrow Maven plugin on <em>feature</em> branches. In Gitflow, a <em>feature</em> branch should only be merged into <em>develop</em> (and <em>master</em>) after being reviewed in a pull request.</p> <p>Here, the necessary pipeline file will be described one part at a time. Click on <a href="https://gist.github.com/luigiwerzowa/aafba402bd36faa573f48a26fc056289" target="_blank" rel="noopener noreferrer">Jenkinsfile.groovy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for the full file.</p> <h3 id="tools-configuration"><a href="#tools-configuration" class="header-anchor">#</a> Tools Configuration</h3> <p>Both the Maven and JDK version have to be specified for the build.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>tools <span class="token punctuation">{</span>
  jdk <span class="token string">'JDK8'</span>
  maven <span class="token string">'maven3'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The referenced names (<code>JDK8</code> and <code>maven3</code>) have to point to a corresponding configuration in <em>Manage Jenkins</em> -&gt; <em>Global Tool Configuration</em>, as seen in the example below.
<a href="/img/maven/jenkins-tools-maven.png"><img src="/img/maven/jenkins-tools-maven.png" alt="Maven integration"></a></p> <h3 id="checkout-and-setting-a-flag"><a href="#checkout-and-setting-a-flag" class="header-anchor">#</a> Checkout and Setting a Flag</h3> <p>The purpose of this step is to checkout the current commit, to check if the last commit was done by jSparrow and to set a flag if that has been the case.</p> <p>A declarative pipeline automatically creates a checkout stage by default. To avoid that, we use the option <code>skipDefaultCheckout true</code> and create our own checkout stage.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>options <span class="token punctuation">{</span>
  skipDefaultCheckout <span class="token boolean">true</span>
<span class="token punctuation">}</span>

environment <span class="token punctuation">{</span>
  JSPARROW_FLAG <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

stages <span class="token punctuation">{</span>
  <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Checkout'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    steps <span class="token punctuation">{</span>
      checkout scm
      script <span class="token punctuation">{</span>
        result <span class="token operator">=</span> sh <span class="token punctuation">(</span>script<span class="token punctuation">:</span> <span class="token string gstring">&quot;git log -1 --pretty=%B | grep '\\[jSparrow\\]'&quot;</span><span class="token punctuation">,</span> returnStatus<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          JSPARROW_FLAG <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
        echo <span class="token string gstring">&quot;jSparrow flag: &quot;</span> <span class="token operator">+</span> JSPARROW_FLAG
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In order to avoid endless build loops, a flag (<code>JSPARROW_FLAG</code>) is set to <code>false</code> whenever the current commit has been done by jSparrow. In this example, the flag is set whenever the commit message contains <code>[jSparrow]</code>.</p> <h3 id="jsparrow-execution"><a href="#jsparrow-execution" class="header-anchor">#</a> jSparrow Execution</h3> <p>This step can be split into three main parts:</p> <ol><li>Deciding on whether or not to trigger jSparrow</li> <li>Executing jSparrow</li> <li>Pushing the changes to Git</li></ol> <h4 id="whether-or-not-to-trigger-jsparrow"><a href="#whether-or-not-to-trigger-jsparrow" class="header-anchor">#</a> Whether or Not to Trigger jSparrow</h4> <p>By default, all conditions within a <a href="https://www.jenkins.io/doc/book/pipeline/syntax/#when" target="_blank" rel="noopener noreferrer"><code>when</code> directive<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> must be true in order for the stage to be executed.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>when <span class="token punctuation">{</span>
  <span class="token comment">// only execute on feature branches..</span>
  branch pattern<span class="token punctuation">:</span> <span class="token string gstring">&quot;feature/.*&quot;</span><span class="token punctuation">,</span> comparator<span class="token punctuation">:</span> <span class="token string gstring">&quot;REGEXP&quot;</span>
  <span class="token comment">// ..and if the JSPARROW_FLAG is still true</span>
  expression <span class="token punctuation">{</span>
    JSPARROW_FLAG<span class="token punctuation">.</span><span class="token function">toBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The purpose of this <code>when</code> condition is to make sure that the current branch is a <em>feature</em> branch and that the flag is still true.</p> <h4 id="executing-jsparrow"><a href="#executing-jsparrow" class="header-anchor">#</a> Executing jSparrow</h4> <p>In this step we make use of the previously defined <code>JSPARROW_LICENSE</code> (see <a href="/maven/build-integration.html#license-key-as-secret-text">License Key as Secret Text</a>) and <code>JSPARROW_CONFIG</code> (see <a href="/maven/build-integration.html#jsparrow-config-file">jSparrow Config File</a>).</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>environment <span class="token punctuation">{</span>
  JSPARROW_LICENSE <span class="token operator">=</span> <span class="token function">credentials</span><span class="token punctuation">(</span><span class="token string">'JSPARROW_LICENSE'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

steps <span class="token punctuation">{</span>
  <span class="token comment">// make the jsparrow.yml available with via configFileProvider</span>
  <span class="token function">configFileProvider</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">configFile</span><span class="token punctuation">(</span>fileId<span class="token punctuation">:</span> <span class="token string">'JSPARROW_CONFIG'</span><span class="token punctuation">,</span> targetLocation<span class="token punctuation">:</span> <span class="token string">'/tmp/jsparrow.yml'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    sh <span class="token string gstring">&quot;mvn jsparrow:refactor -Dlicense=<span class="token expression"><span class="token punctuation">$</span>JSPARROW_LICENSE</span> -DconfigFile=/tmp/jsparrow.yml&quot;</span>

  <span class="token punctuation">}</span>
  <span class="token punctuation">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A declarative pipeline offers an <a href="https://www.jenkins.io/doc/book/pipeline/syntax/#environment" target="_blank" rel="noopener noreferrer"><code>environment</code> directive<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to access credentials (e.g., a secret text) and set the content to an environment variable (<code>JSPARROW_LICENSE</code>). This environment variable is then accessed within a shell command (<code>sh</code>) by using a dollar sign: <code>$JSPARROW_LICENSE</code>.</p> <p>The <a href="https://www.jenkins.io/doc/pipeline/steps/config-file-provider/#configfileprovider-provide-configuration-files" target="_blank" rel="noopener noreferrer"><code>configFileProvider</code> plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is used to make the <code>JSPARROW_CONFIG</code> file available to the build in a local path. Here, the config file is placed into <code>/tmp/jsparrow.yml</code>. This path is then passed to the jSparrow execution.</p> <p>All that remains is to call the <a href="/maven/getting-started.html#refactor"><code>jsparrow:refactor</code> goal</a> with the two resouces.</p> <h4 id="pushing-the-changes-to-git"><a href="#pushing-the-changes-to-git" class="header-anchor">#</a> Pushing the Changes to Git</h4> <p>After running jSparrow, the changes have to be committed and pushed to the original repository, in order for the changes to be persisted.</p> <p>As long as the <code>GitPublisher</code> plugin does not support pushing (see <a href="https://issues.jenkins-ci.org/browse/JENKINS-28335" target="_blank" rel="noopener noreferrer">JENKINS-28335<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>), a workaround is required for pushing changes. The <a href="https://plugins.jenkins.io/ssh-agent/" target="_blank" rel="noopener noreferrer">SSH Agent plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> can make use of already defined SSH credentials and will therefore be used in this example.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token function">sshagent</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'SSH_KEY_ID'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  sh <span class="token string gstring">&quot;git config user.name 'jSparrow'&quot;</span>
  sh <span class="token string gstring">&quot;git config user.email 'info@jsparrow.io'&quot;</span>
  sh <span class="token string gstring">&quot;git add --all&quot;</span>
  sh <span class="token string gstring">&quot;git commit -m '[jSparrow] automatic refactoring'&quot;</span>
  sh <span class="token string gstring">&quot;git push origin HEAD:<span class="token expression"><span class="token punctuation">$</span>env<span class="token punctuation">.</span>BRANCH_NAME</span>&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li>The <code>sshagent</code> references an SSH key by ID. See the following screenshots as reference:
<a href="/img/maven/jenkins-config-ssh.png"><img src="/img/maven/jenkins-config-ssh.png" alt="add ssh key to jenkins"></a></li> <li>Note: The commit message contains <code>[jSparrow]</code>. This is used as an indicator to set the <code>JSPARROW_FLAG</code> (see <a href="/maven/build-integration.html#checkout-and-setting-a-flag">Checkout and Setting a Flag
</a>).</li> <li>Jenkins always checks out single commits as <em>detached HEAD</em>. For this reason, we need to specify the branch to push to. Jenkins provides an environment variable <code>env.BRANCH_NAME</code>, which makes it easy to determine the refspec destination.</li></ol> <h2 id="end-result"><a href="#end-result" class="header-anchor">#</a> End Result</h2> <p>In the end, the pipeline should be triggered whenever both of the following conditions are met:</p> <ol><li>The commit in question is done on a <em>feature</em> branch.</li> <li>The commit in question is not done by a jSparrow refactoring (i.e., the commit message does not contain <code>[jSparrow]</code>).</li></ol> <p>The screenshot below shows an example of a <em>feature</em> branch commit triggering jSparrow, followed by a <code>[jSparrow]</code> commit, which skips the jSparrow step.</p> <p><a href="/img/maven/jenkins-jsparrow-run.png"><img src="/img/maven/jenkins-jsparrow-run.png" alt="jSparrow Refactoring"></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/maven/additional-configuration.html" class="prev">
        Additional Configuration
      </a></span> <span class="next"><a href="/maven/troubleshooting.html">
        Troubleshooting
      </a>
      →
    </span></p></div> <div class="footer"><hr> <div class="footer-links"><p>
    jSparrow is a brand of ©2004-2022 Splendit IT Consulting GmbH | 
      <a href="https://jsparrow.io/wp-content/uploads/Impressum.pdf">Impressum | </a> <a href="https://jsparrow.io/wp-content/uploads/Software-download-terms.pdf">Software Download Terms | </a> <a href="https://jsparrow.io/wp-content/uploads/Digital-store-terms.pdf">Digital Store Terms | </a> <a href="https://jsparrow.io/wp-content/uploads/Terms-and-conditions-of-use.pdf">Website Terms | </a> <a href="https://jsparrow.io/wp-content/uploads/EULA.pdf">EULA | </a> <a href="https://jsparrow.io/wp-content/uploads/GDPR.pdf">GDPR | </a> <a href="https://jsparrow.io/wp-content/uploads/Privacy-and-cookies-policy.pdf">Privacy and Cookies</a></p></div></div><div data-app="true" id="app" class="application theme--light"><div class="application--wrap"><div id="buy" class="buy-link"><a href="https://jsparrow.io/report-an-issue" target="_blank" class="v-btn theme--light" style="background-color:#00000;border-color:#00000;"><div class="v-btn__content">
      Support
      <i aria-hidden="true" class="v-icon .v-icon--right v-icon--right material-icons theme--dark" style="font-size:16px;">help</i></div></a></div></div></div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.aac9ad5f.js" defer></script><script src="/assets/js/17.56318689.js" defer></script><script src="/assets/js/5.1b99d8b2.js" defer></script><script src="/assets/js/48.35d3eecc.js" defer></script>
  </body>
</html>
