---
title: Use SecureRandom
ruleId: UseSecureRandom
since: 3.20.0
minJavaVersion: 1.2
remediationCost: 5
links:
    - displayName: "S2245"
      url: "https://sonarcloud.io/organizations/default/rules?open=java%3AS2245&q=pseudorandom"
    
description:
    This rule prevents vulnerabilities due to a pseudo-random number generator (PRNGs) by replacing it by a cryptographically strong random number generator (RNG).
tags: ["Free", "Java 1.2", "Security"]
---

# Use SecureRandom

## Description

Because the class [`java.util.Random`](https://docs.oracle.com/javase/8/docs/api/java/util/Random.html) relies on a pseudo-random number generator, it should not be used for security-critical applications. An attacker might be able to guess the next value generated by a pseudo-random number generator and thus access sensitive data.
A more secure alternative is the class [`java.security.SecureRandom`](https://docs.oracle.com/javase/8/docs/api/java/security/SecureRandom.html) which relies on a cryptographically strong random number generator (RNG). 
This rule replaces invocations of the constructors [`Random()`](https://docs.oracle.com/javase/8/docs/api/java/util/Random.html#Random--) and [`Random(long seed)`](https://docs.oracle.com/javase/8/docs/api/java/util/Random.html#Random-long-) with invocations of [`SecureRandom`](https://docs.oracle.com/javase/8/docs/api/java/security/SecureRandom.html#SecureRandom--). In case of a seed argument, an additional statement is generated to invoke [`setSeed(long seed)`](https://docs.oracle.com/javase/8/docs/api/java/util/Random.html#setSeed-long-). 
Sonarcloud marks [this issue](https://sonarcloud.io/organizations/default/rules?open=java%3AS2245&q=pseudorandom) as "Critical" by default.

## Benefits

Prevents generating predictable pseudo-random numbers.

## Tags

::: tip Tags
<TagLinks />
:::

## Code Changes


### Using Constructor Without Any Argument

__Pre__
```java
Random random = new Random();
byte[] bytes = new byte[20];
random.nextBytes(bytes);
```

__Post__
```java
Random random = new SecureRandom();
byte[] bytes = new byte[20];
random.nextBytes(bytes);
```

### Using Constructor With Seed Argument

__Pre__
```java
Random random = new Random(System.currentTimeMillis());
byte[] bytes = new byte[20];
random.nextBytes(bytes);
```

__Post__
```java
Random random = new SecureRandom();
random.setSeed(System.currentTimeMillis());
byte[] bytes = new byte[20];
random.nextBytes(bytes);
```

<VersionNotice />
## Properties

<RuleProperties />
